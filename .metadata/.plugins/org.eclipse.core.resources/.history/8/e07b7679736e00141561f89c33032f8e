package com.ibm.mil;

import io.selendroid.SelendroidCapabilities;
import io.selendroid.SelendroidConfiguration;
import io.selendroid.SelendroidDriver;
import io.selendroid.SelendroidLauncher;

import org.junit.AfterClass;
import org.junit.Assert;
import org.junit.BeforeClass;
import org.junit.Test;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;

public class MetricTabTest {
	private static SelendroidLauncher selendroidServer = null;
	private static WebDriver driver = null;

	@BeforeClass
	public static void setup() throws Exception {
		SelendroidConfiguration config = new SelendroidConfiguration();
		// Add the selendroid-test-app to the standalone server
		config.addSupportedApp("/Users/atcabral/Ready.App.Physical.Therapist/platforms/android/build/outputs/apk/android-debug.apk");
		selendroidServer = new SelendroidLauncher(config);
		selendroidServer.launchSelendroid();

		SelendroidCapabilities caps = new SelendroidCapabilities(
				"com.ibm.cio.be.MIL.ReadyAppPT:0.0.1");
		driver = new SelendroidDriver(caps);
	}

	@AfterClass
	public static void stopSelendroidServer() {
		if (driver != null) {
			driver.quit();
		}
		if (selendroidServer != null) {
			selendroidServer.stopSelendroid();
		}
	}

	// TODO: This test currently tests that the metric tabs exist. As the
	// application is fleshed out more, this test should become more robust

	@Test
	public void test1() {
		WebElement user = driver.findElement(By.id("patient_id"));
		WebElement password = driver.findElement(By.id("password"));

		user.sendKeys("user1");
		password.sendKeys("password1");

		// Select the login button
		WebElement loginButton = driver.findElement(By.id("login_button"));
		loginButton.click();

		// Wait for next page to load
		try {
			Thread.sleep(2000);
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

		WebElement metricsTabs = driver.findElement(By.id("metrics_tabs_area"));
		Assert.assertNotNull("Metrics tabs area exists", metricsTabs);
	}

}