<!DOCTYPE html>
<html lang="en">
    
    <head>
        <!-- Title -->
        <title>ReadyApp PT Docs</title>
        
        <!-- Style -->
        <link rel="stylesheet" type="text/css" href="../css/style.css">
    </head>
    
    <body>
        
        <div class="header">        
            <img class="logo" src="../img/logo.png" />
            <span class="header-text">Installation &amp; Getting Started</span>
            
            <div class="header-link-container">
                <a href="../index.html"><span class="header-link" id="home"><img src="../img/Home.png" class="home-icon"/></span></a>
                
                <span class="header-link" id="start">Start<img src="../img/Menu.png" class="icon"/>
                    <ul>
                        <a href="../assets/IBM_dl_v1.pdf" target="_blank"><li><span>IBM Design Language <img src="../img/Tab.png" class="icon"/></span></li></a>
                        <a href="dg.html"><li><span>Design Guidelines</span></li></a>
                        <a href="arch.html"><li><span>Physio Architecture</span></li></a>
                        <a href="igs.html"><li><span>Installation &amp; Getting Started</span></li></a>
                    </ul>
                </span>
                
                <span class="header-link" id="frontend">App<img src="../img/Menu.png" class="icon"/>
                    <ul>
                        <a href="../gen/Swift/index.html" target="_blank"><li><span>iOS</span> <img src="../img/Tab.png" class="icon"/></li></a>
                        <a href="../gen/Java/html/index.html" target="_blank"><li><span>Android</span> <img src="../img/Tab.png" class="icon"/></li></a>
                        <a href="../gen/JavaScript/index.html" target="_blank"><li><span>Hybrid</span> <img src="../img/Tab.png" class="icon"/></li></a>
                    </ul>
                </span>
                
                <span class="header-link" id="middleware">Middleware<img src="../img/Menu.png" class="icon"/>
                    <ul>
                        <a href="../MobileFirst/gen/Java/html/index.html" target="_blank"><li><span>Java</span> <img src="../img/Tab.png" class="icon"/></li></a>
                        <a href="../MobileFirst/gen/Javascript/global.html" target="_blank"><li><span>JavaScript</span> <img src="../img/Tab.png" class="icon"/></li></a>
                    </ul>
                </span>
            </div>
        </div>
        
        <div class="container">
        
            <h1>Installation &amp; Getting Started</h1>
            
            <p>This guide will help you get started developing your own application with Physio. Use the contents box below to skip to section of the guide you are most interested in.</p>
            
            <div class="index-box">
                <div class="index-container">
                    <h3>Contents</h3>
                    
                    <ul>
                        <li><a href="#prereqs">Prerequisites</a></li>
                        <li><a href="#setting-up-backend">MobileFirstPlatform & MongoDB Setup</a>
                            <ul>
                                <li><a href="#install-wl-server">Installing MobileFirst Server</a>
                                <li><a href="#install-mongo-db">Installing and Populating MongoDB</a>
                                <li><a href="#localization">Localizing MongoDB</a>
                                <li><a href="#server-side-java">MongoDB Java Server-Side Code</a>
                                <li><a href="#adapters">Middleware Adapter Layer</a>
                                <li><a href="#security">Adapter Security</a>
                                <li><a href="#update-wl-files">Deploying and Updating Adapter/Native Application Files on Server</a>
                            </ul>
                        <li><a href="#building">Building the Apps</a>
                            <ul>
                                <li><a href="#getting-hybrid-in">Hybrid</a></li>
                                <li><a href="#ios-build">iOS</a></li>
                                <li><a href="#android-build">Android</a></li>
                                <li><a href="#build-logging-in">Logging In</a></li>
                            </ul>
                        </li>
                        <li><a href="#dev-hybrid">Developing Hybrid</a>
                        <li><a href="#hybrid-unit-tests">Running Hybrid Unit Tests</a>
                    </ul>
                </div>
            </div>
            
            
            <!-- Seperate -->
            
            <h1 id="prereqs">Prerequisites</h1>
            
            <table>
                <thead>
                    <th class="apink">IBM Mobile First Platform</th>
                </thead>
                <tbody>
                    <tr>
                        <td class="pink">
                            <ul>
                                <li>MobileFirst Platform 6.3</li>
                                <li>MobileFirst Studio 6.3</li>
                                <li>MongoDB</li>
                                <li>Java 1.7 SDK</li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <table>
                <thead>
                    <th class="ablue">iOS</th>
                    <th class="agreen">Android</th>
                    <th class="aaqua">Hybrid</th>
                </thead>
                <tbody>
                    <tr>
                        <td class="blue">
                            <ul>
                                <li>OS X 10.9 (or higher)</li>
                                <li>Xcode 6.1.1</li>
                                <li>Apache Ant 1.9.4</li>
                                <li>Java 1.7 SDK (For Ant and UI Automated tests)</li>
                                <li><a href="https://developer.apple.com" target="_blank">iOS developer ID</a></li>
                                <li>iOS provisioning profile with these services:</li>
                                <ul>
                                    <li>App Groups</li>
                                    <li>Health Kit</li>
                                </ul>
                            </ul>
                        </td>
                        <td class="green">
                        <ul>
                        <li> OS X 10.9 (or higher) or Windows 7 (or higher)</li>
                        <li>Android Studio 1.0.1</li>
                        <li>The following with the Android SDK Manager:
                            <ul>
                                <li>Android 5.0-4.1.2 (API 21-16)</li>
                                <li>Android SDK Tools v23.0.5</li>
                                <li>Android SDK Platform-tools v21</li>
                                <li>Android SDK Build-tools v21.1.1 and v21.0.2</li>
                                <li>All items under the "Extras" directory</li>
                            </ul>
                        </li>
                        <li>Apache Ant 1.9.4</li>
                        <li>Gradle 2.2.1</li>
                        <li>Java 1.7 SDK</li>
                        <li>Intel Hardware Accelerated Execution Manager (HAXM) v1.1.1 (or higher) </li>
                        <li>Certificate with these enabled:
                            <ul>
                                <li><a href="https://developers.google.com/fit/android/get-started#step_1_get_google_play_services" target="_blank">Google Fit</a></li>
                                <li><a href="https://developers.google.com/youtube/android/player/register" target="_blank">YouTube</a></li>
                            </ul>
                        </li>
                    </ul>
                        </td>
                        <td class="aqua">
                            <ul>
                                <li>Node.js</li>
                                <li>Sass</li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <table style="margin-top: 25px;">
                <thead>
                    <th>Tested iOS Devices</th>
                    <th>Tested Android Devices</th>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <ul>
                                <li>iPhone 5S</li>
                                <li>iPhone 6</li>
                                <li>iPhone 6 Plus</li>
                            </ul>
                        </td>
                        <td>
                            <ul>
                                <li>Nexus 5</li>
                                <li>HTC One</li>
                                <li>Samsung Galaxy Note 3</li>
                                <li>Samsung Galaxy Note 4</li>
                                <li>Samsung Galaxy S4</li>
                                <li>Samsung Galaxy S5</li>
                                <li>LG G2</li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>

            <h1 id="setting-up-backend">MobileFirst Platform &amp; MongoDB Setup</h1>

            <p> ReadyApps uses the IBM MobileFirst Platform backend which includes a web application server, a local 
                development environment which runs in Eclipse, and a middleware layer. The web application server will
                interact with an existing SQL/NoSQL backend database system. For this use case, we are using MongoDB as
                the backend database and interacting with it using the MongoDB Java Driver. To install the production web
                application server, please follow the instructions on this <a href="http://www-01.ibm.com/support/knowledgecenter/SSHS8R_6.3.0/com.ibm.worklight.installconfig.doc/admin/c_installation.html?lang=es" target="_blank">page</a>.</p>

                Here are the steps to installing a local MobileFirst Server in the Eclipse IDE

                <h3 id="install-wl-server">1. Installing and configuring MobileFirst Platform with Eclipse Luna</h3>
                <p> Download and install <a href="https://projects.eclipse.org/releases/luna" target="_blank">Eclipse Luna</a>. Open Eclipse and click on Help -> Eclipse Marketplace</p>
                    <div class="left">
                        <img src="../img/eclipse-market.png" style="height:400px;margin-top:25px;" />
                        <img src="../img/eclipse-6-3-install.png" style="height:400px;margin-top:25px;" />
                    </div>
                <p> In the 'Find' field, type MobileFirst Platform 6.3. Once the results come up, click install Eclipse will prompt you to confirm the install and suggest restarting Eclipse for the install to complete. </p>

                <p> Once the install is completed and Eclipse has restarted, unzip the source code zip file (ReadyAppsPT.zip). In this folder, you will find several sub-folders. The source for Android and iOS native applications reside in the "Android" and
                "iOS" folders. The MobileFirst Platform server side code resides in the "ReadyAppsMobileFirst" folder. We need to import the contents on this folder into our Eclipse workspace as this is the Eclipse project we will be working with. </p>

                <p> Follow the below steps to import the project into your Eclipse workspace: </p>

                    <ul>
                        <li>Go back to your Eclipse IDE and change your view to the Package Explorer. This can be accessed via Window -> Show View -> Other -> Project Explorer menu option. This will open up the Project Explorer in the left panel of your Eclipse workspace. </li>
                        <li>Right click on the Package Explorer and select "Import". In the resulting dialog, find and expand the Git folder and select "Project from Git". </li>
                        <li>Select "Existing local repository"</li>
                        <li>In the "Select a Git Repository" dialog, click on "Add" and navigate to location where you unzipped the ReadyAppsPT.zip file and select it.</li>
                        <li>Select "ReadyAppsMobileFirst" folder in the resulting dialog and click on Finish to complete the import</li>
                        <div class="left">
                        <img src="../img/eclipse-import.png" style="height:350px;margin-top:25px;" />
                        <img src="../img/eclipse-git.png" style="height:350px;margin-top:25px;" />
                        <img src="../img/eclipse-existing.png" style="height:350px;margin-top:25px;" />
                        <img src="../img/eclipse-select-project.png" style="height:350px;margin-top:25px;" />
                    </div>

                    </ul>

                <h3 id="install-mongo-db">2. Installing and Populating MongoDB</h3>

                <p> Similar to the production MobileFirst Platform web application server, you will need to install MongoDB on your backend Linux/Unix/Windows server to store data. If you have an existing database, you can skip this step. In order to install MongoDB on your backend respective server, please follow the instructions provided <a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-linux/#install-mongodb" target="_blank">here</a></p>

                <p> We will now install a local MongoDB instance for development purposes. The below instructions are specific to <a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-os-x/" target="_blank">Mac OSX</a>. Refer to the MongoDB install link for instructions to your platform.  </p>
                    <ul>
                        <li>Download the binary files for MongoDB 2.6.
                             <div class="well">
                                <code>curl -O http://downloads.mongodb.org/osx/mongodb-osx-x86_64-2.6.6.tgz</code>
                            </div>
                        </li>
                        <li>Extract the files from the downloaded archive.
                            <div class="well">
                                <code>tar -zxvf mongodb-osx-x86_64-2.6.6.tgz</code>
                            </div>
                        </li>
                        <li>Copy the extracted archive to the target directory.
                             <div class="well">
                                <code>mkdir -p mongodb</code>
                                <code>cp -R -n mongodb-osx-x86_64-2.6.6/ mongodb</code>
                            </div>
                        </li>
                        <li>Add the MongoDB <code>bin</code> directory to your <code>PATH</code> variable.
                            <div class="well">
                                <code>export PATH="mongodb-install-directory"/bin:$PATH</code>
                            </div>
                        </li>
                        <li>Create the data directory to which the <code>mongod</code> process will write data. By default, the <code>mongod</code> process uses the <code>/data/db</code> directory. If you create a directory other than this one, you must specify that directory in the <code>dbpath</code> option when starting the <code>mongod</code> process.
                            <div class="well">
                                <code>mkdir -p /data/db</code>
                            </div>
                        </li>
                        <li>Run MongoDB by running the following command in the terminal:
                            <div class="well">
                                <code>mongod</code>
                            </div>
                            If you are not in the data directory which you created in the previous step, you can start the database with this command:
                            <div class="well">
                                <code>mongod --dbpath "path-to-data-dir"</code>
                            </div>
                        </li>
                        <li>To execute database commands via terminal, run a <code>mongo</code> shell. Open a new terminal window and type:
                            <div class="well">
                                <code>mongo</code>
                            </div>
                        </li>
                        <li>Finally, create the database which we will populate in the next section. Type the below command in the <code>mongo</code> shell:
                            <div class="well">
                                <code>use readyapps_db</code>
                            </div>
                        </li>
                    </ul>

                <p> Our database is up and running! We can now populate the database with some dummy data provided in the project. The database population script (<code>populate_db.js</code>) is located in the <code>ReadyAppsMobileFirst/resources/</code>. Open a new terminal window and navigate to the directory where the script is located and run the below command to populate the database: </p>
                    <div class="well">
                        <code>mongo localhost:27017/readyapps_db --quiet populate_db.js</code>
                    </div>
                <p> Restart the <code>mongo</code> shell to access the data via command line. We are now ready to hook up the MobileFirst Platform Server/MongoDB with iOS/Android native clients.
                </p>


                <h3 id="localization">3. Localizing MongoDB</h3>
                <p> In order to localize the database to a specific language, we will have to add the appropriate translations into populate_db.js. 


                Currently we are localizing the following strings: </p>
                <ul>
                    <li>routineTitle from the routines collections that will be set in the RoutineViewController and RoutineFragment</li>
                    <li>exerciseTitle, description, and tools from the exercises collection that will be set in ExerciseListViewController and ExerciseFragment</li>
                    <li>questions from the questions collection that will be set in the FormsViewController and FormFragment</li>
                </ul>

                <p>For each item that is being translated, we have a key set in each collection. We then map each key to a strings collection for translation. For example, if we wanted to localize the strings for the exercise collection to English and Spanish, we would do the following:</p>

                <p> Exercise Collection: </p>
                    <div class="left">
                       <img src="../img/exercises-collection.png" style="height:100px;margin-top:10px;" />
                    </div>

                <p> Strings collection to translate exerciseTitle, description, and tools to English and Spanish: </p>
                    <div class="left">
                       <img src="../img/strings-collection.png" style="height:300px;margin-top:10px;" />
                    </div>
                <p> You would do the same thing for each of the strings that have been translated.</p>

                <h3 id="server-side-java">4. MongoDB Java Server-Side Code</h3>

                <p> MongoDB provides support for many languages including Node.js, C/C++, C#, Python, Java, etc. For easy integration with the MobileFirst Platform, we have implemented this server-side in Java. The source code is available in the <code> ReadyAppsMobileFirst/server/java/com/ibm/mil/readyapps/database/MongoDBConnector.java</code>. You can access this code in your Eclipse workspace in the <code>server/java</code> directory. </p>
                    <div class="left">
                       <img src="../img/eclipse-java.png" style="height:200px;margin-top:25px;" />
                    </div>

                <p>This class connects to the local database instance and exposes several functions that pull data for a specific user. You can test out the database connection by running this Java application. Open up the file, right click anywhere in the file and select <code>Run As -> Java Application</code>. In the "Run Config" panel, click "Run". The results of the run will be displayed in the "Console," which is the panel towards the bottom of the screen.</p>
                    <div class="left">
                       <img src="../img/eclipse-run-app.png" style="height:400px;margin-top:25px;" />
                       <img src="../img/eclipse-run-config.png" style="height:400px;margin-top:25px;" />
                       <img src="../img/eclipse-console.png" style="height:400px;margin-top:25px;" />
                    </div>
                <p>You can make changes to this class as you see fit, depending on your data model and backend database. This is a simple and quick way to test the changes you make with the database.
                </p>

                <p> Also note, for whatever language has been localized in the database, if the client locale equals that language, then we return those specific localized strings. Otherwise it defaults to English. Additionally, if you are using a different database, this logic would need to be updated.</p>

                
                <h3 id="adapters">5. Middleware Adapter Layer</h3>

                <p>MobileFirst Adapters include Javascript functions that behave like a REST call from the client to the backend. There are several adapter types available out of the box for various backend needs. These include HTTP, SQL, Cast IRON, and JMS. We are using HTTP adapters for this project. Some benefits that adapters <a href="https://developer.ibm.com/mobilefirstplatform/documentation/getting-started-6-3/server-side-development/adapter-framework-overview/" target="_blank">provide</a>:</p>
                    <ul>
                        <li> <span class="bold">Universality:</span> Support multiple integration technologies and back-end information systems.</li>
                        <li> <span class="bold">Read-only and transactional capabilities:</span> Support read-only and transactional access modes to back-end systems.</li>
                        <li> <span class="bold">Fast Development:</span> Use simple XML syntax and are easily configured with JavaScript API.</li>
                        <li> <span class="bold">Security:</span> use flexible authentication facilities to create connections with back-end systems and offer control over the identity of the connected user.</li>
                        <li> <span class="bold">Transperancy:</span> Data that is retrieved from back-end applications is exposed in a uniform manner, regardless of the adapter type</li>
                    </ul>
                <p>The <code>ReadyAppsAdapter</code> is available in the <code>ReadyAppsMobileFirst/adapters/ReadyAppsAdapter</code> folder. There are two files:  </p>
                <p>
                    1)<code> ReadyAppsAdapter.xml</code> 
               
                     <div class="left">
                       <img src="../img/adapter-functions.png" style="height:200px;margin-top:25px;" />
                    </div>
                </p>
                    2)<code> ReadyAppsAdapter-impl.js</code>.
                     <div class="left">
                       <img src="../img/adapter-impl.png" style="height:400px;margin-top:25px;" />
                    </div>

                 <p>The adapter meta-data and security information is located in the XML file and the implementation of the Javascript functions is located in the <code>ReadyAppsAdapter-impl.js</code>. These function invoke the Java server-side code which we saw in the previous section. Here you can add/delete functions as you see fit. You will notice the <code>securityTest</code> tag next to the procedure name. This is a MobileFirst Platform feature which allows you to protect sensitive functions from the public by adding an authentication layer. In other words, if a user tries to access these function without authenticating, they will be blocked and taken to the login page to reauthenticate. This ensures that the data is secured and only viewable by the user who has been properly authenticated. This will be explained in the next section. </p>

                 <p> In order to quickly test out the adapter functions, right click on the <code>ReadyAppsAdapter</code> folder in Eclipse, select "Run As" -> "Deploy MobileFirst Adapter." This will deploy your local MobileFirst Platform server on your local machine. In the console, you will notice all the logs as the server is being brought up. Once the adapter has been deployed, you will get the <code>Server Host</code> and <code>Server port</code> information. We will be using this information to connect our clients to the server. 

                    <div class="left">
                       <img src="../img/adapter-deploy.png" style="height:400px;margin-top:25px;" />
                       <img src="../img/adapter-console.png" style="height:100px;margin-top:25px;" />
                    </div>

                 <p>To test out our adapter, right click on the <code>ReadyAppsAdapter</code> folder in Eclipse, select "Run As" -> "Invoke MobileFirst Procedure." In the resulting dialog, select "submitAuthentication" as the procedure name. In the parameters field, type <code>"user1","password1"</code>. Click on "Run" to run the procedure. Your default browser should open up with the results. If you entered the correct username and password, you will get a the below result:</p>

                     <div class="left">
                       <img src="../img/adapter-run.png" style="height:300px;margin-top:25px;" />
                       <img src="../img/adapter-submit.png" style="height:300px;margin-top:25px;" />
                       <img src="../img/adapter-result.png" style="height:100px;margin-top:25px;" />
                    </div>
                
                <p> We will explore some of the security features in the next section </p>

                <h3 id="security">6. Adapter Security </h3>

                <p>We have implemented <a href="https://developer.ibm.com/mobilefirstplatform/documentation/getting-started-6-3/authentication-security/adapter-based-authentication/" target="_blank">Adapter Based Authentication</a> for this project. </p> This security feature protects sensitive adapter functions by only allowing authenticated users to access them. We only expose the <code>submitAuthentication</code> function as we will need to use that function to authenticate the user. Depending on the timeout set for your specific application needs, the user will be timed out if they do not access any application features that require a backend call. They will also be logged out if they terminate the app or move it as a background process. This ensures that any sensitive data pertaining to the user is not exposed to anyone else. <p>

                Let's go back to the Eclipse IDE to see how this security feature works. Redeploy the MobileFirst Platform adapter and then invoke the MobileFirst Procedure. Select the <code>getUserObject</code> procedure for the procedure name. Enter <code>"user1"</code> for the paramters and click on "Run." The output you see the browser should be an error stating that authentication is required to invoke this procedure. You will notice that the <code>authRequired</code> parameter is set to true. This means that the user needs to be authenticated. </p>

                    <div class="left">
                       <img src="../img/adapter-invalid.png" style="height:300px;margin-top:25px;" />
                       <img src="../img/adapter-invalid-result.png" style="height:200px;margin-top:25px;" />
                    </div>

                <p> Let's invoke the procedure again, but this time select <code>submitAuthentication</code>, enter <code>"user1","password1"</code> and hit "Run." Now the user has been authenticated. Invoke the <code>getUserObject</code> procedure again, enter <code>user1</code> and hit "Run." This time you, the user object for <code>user1</code> should be returned by the adapter procedure. The <code>authRequired</code> parameter is set to false. </p>

                    <div class="left">
                       <img src="../img/adapter-valid-result.png" style="height:140px;margin-top:25px;" />
                    </div>
                <p>
                Once the user has been authenticated, they can access the protected resources of the application. For this ReadyApps project, those include viewing the exercise library and the forms. If for any reason, the user is timed out due to inactivity or logged out due to app termination, they will be forced to login to access those resources in the future. The timeout can be set manually depending on the needs of your application. In order to set the timeout, navigate to the <code>ReadyAppsMobileFirst/server/conf/worklight.properties</code> file in the Eclipse IDE. Search for the <code>serverSessionTimeout</code> parameter and update the value as needed. This value for the timeout is set in minutes.</p>

                    <div class="left">
                       <img src="../img/worklight-timeout.png" style="height:150px;margin-top:25px;" />
                    </div>
                <p> Redeploy the adapter and you are all set to go! This is a nifty, out-of-the-box feature available to us with very little setup. The tutorial to setup the server-side configuration is available in at this <a href="https://developer.ibm.com/mobilefirstplatform/documentation/getting-started-6-3/authentication-security/adapter-based-authentication/" target="_blank">link</a>. It ensures that the user data is protected while it is transmitted from the server to the client and vice-versa.<p>

                <h3 id="update-wl-files">7. Deploying and Updating Adapter/Native Application Files on Server</h1>
                <p>We have been developing and testing with a local MobileFirst Platform Studio for quick deployment and testing. This is great to quickly learn and test out a prototype. However, in a team setting, we will need to deploy the adapter and application files to a production server running MobileFirst Platform web application server. Everytime the adapter is deployed, an adapter file is generated in the Eclipse project. This holds all the latest adapter code and settings. We need to upload this adapter file to our production MobileFirst Platform web application server. But first, let's deploy the native applications, so the respective native application files will be generated. These will also need to be uploaded to the server. That way, our clients can properly connect to the server. Head over to your Eclipse IDE and expand the <code>ReadyAppsMobileFirst/apps</code> folder. There are two folders: 1) <code>ReadyAppsMobileFirstAndroid</code> and 2) <code>ReadyAppsMobileFirstiOS</code>. Right click on the Android folder -> select "Run As" -> "Deploy Native API." Once the app has been deployed, you will see a message on the console stating the successful deployment. Repeat the same steps with the iOS folder. After deploying the adapter and application files, navigate to the <code>ReadyAppsMobileFirst/bin</code> folder in your Eclipse IDE. There should be four generated files:</p>
                    <div class="left">
                       <img src="../img/worklight-bin.png" style="height:150px;margin-top:25px;" />
                    </div>

                <p> The <code>ReadyAppsMobileFirst.war</code> file is generated when whole application is built. This file includes the Java server-side database code and any external libraries defined in the classpath. This file also needs to be deployed in the MobileFirst Platform server runtime. You can FTP or SCP the file onto a location on your production server either via command line or a file transfer tool. To transfer via command line, navigate to the <code>ReadyAppsMobileFirst/bin</code> directory and execute the below <code>scp</code> command to securely transfer the file to the production server:</p>
                    <div class="well">
                        <code>scp ReadyAppsMobileFirst.war admin@"hostname.xxx.xxx.com":/home/admin</code>
                    </div>
                <p> Once the <code>war</code> file has been transferred, <code>ssh</code> into your production server. Ensure the web application server and accompanying MySQL/DB2 database has been installed and configured. Find a file called <code>configuration-tool.sh</code>, which should be in one of the sub-folder of the MobileFirstPlatform web application server installation. Run that on the command line using the below command: </p>
                    <div class="well">
                        <code>./configuration-tool.sh</code>
                    </div>
                <p> We will now create a runtime configuration for our project and deploy the necessary files, so our clients can connect to the backend</p>
                    <ul>
                        <li>In the server configuration dialog, click on "Add a MobileFirst runtime environment to a configuration"
                            <div class="left">
                                <img src="../img/server-config.png" style="height:350px;margin-top:25px;" />
                            </div>
                        </li>
                        <li>Select your application configuration and enter the name of the application. For this project, we can name it <code>ReadyAppsMobileFirst</code>. Click OK.
                        </li>
                        <li>We will now have to upload the <code>ReadyAppsMobileFirst.war</code> file. Click on "Browse" and navigate to location where you transferred the <code>war</code> from your laptop to the server.
                            <div class="left">
                                <img src="../img/worklight-war.png" style="height:350px;margin-top:25px;" />
                            </div>
                        </li>
                        <li>Click on "Update WAR" button to complete the upload</li>
                        <li>Your runtime is now complete. The runtime is accessable via the browser via a defined URL based on your hostname and port. For example, here is a sample URL <p>
                             <div class="well">
                                <code>http://milmobilefirst.ibm.com:9080/worklightconsole/index.html#ReadyAppsMobileFirst,catalog</code>
                            </div> </p>
                        </li>
                        <li>Login with your MobileFirst admin credentials. The default login is <code>demo/demo</code> for the username and password</li>

                        <li>You should now see the IBM MobileFirst Platform Operations Console with the ReadyAppsMobileFirst runtime <p>
                             <div class="left">
                                <img src="../img/mf-runtime.png" style="height:150px;margin-top:25px;" />
                            </div></p>
                        </li>
                        <li>Depending on your production server configuration, this URL can be accessed from outside the server from any machine. We will now upload the adapter and application files to this runtime. Click on "Browse" and navigate to the <code>ReadyAppsMobileFirst/bin</code> directory on your local machine and select the adapter file. Click on "Submit." The adapter file should successfully upload to the runtime. Repeat the same steps with the native iOS and Android application files. Once complete, you should see all three files deployed to the runtime:<p>
                            <div class="left">
                                <img src="../img/mf-runtime-success.png" style="height:400px;margin-top:25px;" />
                            </div></p>
                        </li>                    
                    </ul>

                    <p> These steps need be repeated everytime there is a change to any server-side Java code and/or adapter code. Since we are building native client applications, there won't be many changes made to those files. We are now done with setting up the MobileFirst Platform backend!


            <h1 id="building">Building the Apps</h1>
            
            <p>
                In order to build the native applications you will need to have extracted the
                application source code (ReadyAppPT.zip) somewhere on your file system. From
                here on out this location will be referred to as <code>&lt;READYAPPPT_HOME&gt;</code>.  
            </p>
            
            <h2 id="getting-hybrid-in">Getting Hybrid Code In the Apps</h2>
            
            <p> 
                The first step to getting the iOS application to run in a Simulator is to ensure
                that you have the latest hybrid code inside of the native application.  As the
                hybrid code (html/js/css) is shared, it lives outside of either native 
                application and anytime changes are made to the hybrid code they need to be
                copied into the native directories.
            </p>
            <p>
                In order to copy the hybrid files into the native directories, ensure that you
                have ant installed and that ant is in your PATH. Go to the <code>&lt;READYAPPPT_HOME&gt;</code>
                directory and run the following command from your shell:
            </p>
            
            <div class="well">
                <code>$ ant build</code>
            </div>
            
            <p>
                You should see comments on what is getting copied and a "Build Successful" message
                if everything went well.
            </p>
            
            <h2 id="ios-build">Building the iOS App</h2>
            
            <p> 
                From here on out we assume that you have successfully put the hybrid code into the iOS application directory, as outlined <a href="#getting-hybrid-in">here</a>.
            </p>
            
            <h3>1. Open ReadyApp PT in Xcode</h3>
            
            <p>
                First, open Xcode 6.1.  When Xcode starts, open the ReadyAppPT project.  To do this,
                choose <span class="bold">File &gt; Open...</span> in Xcode.  In the menu that comes up navigate to the
                <code>&lt;READYAPPPT_HOME&gt;/iOS</code> directory and click on the <span class="bold">ReadyAppPT.xcodeproj</span> file and
                choose <span class="bold">Open</span>.
            </p>
            
            <h3>2. Update Provisioning Profile for Project</h3>
            
            <p>
                Update the provisioning profile used to compile the application so that features
                like Health Kit are enabled in app. With the Xcode IDE open, click on the 
                <span class="bold">ReadyApp PT</span> icon in the file navigator on the left-hand side.  
                This should open
                up a menu with project settings. Choose <span class="bold">ReadyAppPT</span> under the Project header. 
                Choose <span class="bold">Build Settings</span>. Find the <span class="bold">Code Signing</span> 
                section. You may need to update the value for
                the <span class="bold">Provisioning Profile</span> key to your provisioning profile with the required
                services enabled. Check the <a href="#prereqs">Prerequisites</a> section
                to see what services are needed.
            </p>
            
            <h3>3. Update Provisioning Profile for Targets</h3>
            
            <p>
                We may need to repeat the above process for the target settings.  There are
                two targets: ReadyAppPT and ReadyAppPT-Tests.
                Choose <span class="bold">ReadyAppPT</span> under the Targets header, then choose <span class="bold">Build Settings</span> at the
                top and find the <span class="bold">Code Signing</span> section.  Check
                the value for the provisioning profile and change if needed. Repeat this process for the
                ReadyAppPT-Tests target.
            </p>

            <h3>4. Update MobileFirst Platform Server Properties </h3>

            <p> We need to point the app to the MobileFirst server backend in order to properly leverage all the features and functionalities. You may point to a local server running on your laptop or a production server. In XCode, navigate to the <code>Resource</code> folder and open up the <code>worklight.plist</code> file. Update the <code>host</code> and <code>port</code> values to point to the appropriate server. The MobileFirst APIs have been integrated with the XCode project, so there is no other configuration required. </p>

                    <div class="left">
                        <img src="../img/xcode-wl.png" style="height:400px;margin-top:25px;" />
                    </div>
            
            <h3>5. Compile &amp; Run</h3>
            
            <p>
                To compile and run the application in the simulator of your choice, click on the
                play button at the top left of the IDE.
                Next to it will be a stop button 
                and next to that, the name of the app.  Click on the name of the app. In the menu
                that opens you should see on the right side a list of available simulators you
                can run the application against. Choose <span class="bold">iPhone 6</span>. 
                You should be able to
                click on the play button and Xcode should compile the application successfully,
                start the selected simulator, install the application into it,
                and start the application.</p>
            
            <h2 id="android-build">Building the Android App</h2>
            
            <p> 
                From here on out we assume that you have successfully put the hybrid code into the Android application directory, as outlined <a href="#getting-hybrid-in">here</a>.
            </p>
            
            <h3>1. Open Physio in Android Studio</h3>
            
            <p>
                When you first start Android Studio, it might ask you to point to your Gradle
                installation as Android Studio does not provide a copy.  Simply point to the 
                directory where you unzipped the Gradle file into.  You should then see the 
                "Welcome to Android Studio" screen.  Choose <span class="bold">Open an Existing Android Studio project</span> in the quick start pane.  Go to the 
                <code>&lt;READYAPPPT_HOME&gt;/Android/Physio</code> directory and select the <code>build.gradle</code> file. Choose <span class="bold">OK</span>.
                The project should now begin opening.  To be safe, 
                choose <span class="bold">Tools > Android > Sync Project with Gradle
                Files</span>.  
            </p>
            
            <h3>2. Create an Emulator</h3>
            
            <p>
                Before you can actually run the application you have to create an Android
                emulator. To do this open the Android Virtual Device (AVD) manager by choosing <span class="bold">Tools > Android > AVD Manager</span>.  Choose <span class="bold">Create...</span>
                 to open up the "Create new Android Virtual Device (AVD)" menu.  The most
                important settings to set are the following:
            </p>
            <p>
                <ul>
                    <li>Choose the <span class="bold">Nexus 5 (4.95", 1080x1920: xxhdpi)</span> device</li>
                    <li>Choose <span class="bold">Google APIs (Google Inc.) - API Level 21</span></li>
                    <li>Choose <span class="bold">Google APIs Intel Atom (x86)</span></li>
                    <li>Deselect the keyboard checkbox (ensures that tests run cleanly)</li>
                    <li> Check <span class="bold">Use Host GPU</span></li>
                </ul>
            </p>
            <p>
                These options help ensure the best performance and allows you to actually get
                access to the Google Fit APIs in the emulator. Otherwise, you're stuck trying to
                figure out how to get Google Services in the emulator which is next to impossible.
                Once the emulator is defined, start it and close the AVD manager.
            </p>
        
            <h3>3. Add Signing Configuration to Gradle Build</h3>
        
            <p>
                Before you attempt to build the application, you need to update the <code>build.gradle</code>
                file associated with the app directory. In the file browser for and project, you
                should see a collapsable section for <span class="bold">Gradle Scripts</span>. 
                You want to modify the
                <code>build.gradle</code> (app) file so that you add a signing configuration with your 
                custom certificate.  Add the following lines:
            </p>
        
            <div class="well">
                <pre><code>signingConfigs {
    config {
        keyAlias '&lt;Your-certificate-alias&gt;'
        keyPassword '&lt;Your-certificate-password&gt;'
        storeFile file('&lt;The-qualified-path-to-your-certificate&gt;')
        storePassword '&lt;Your-keystore-password&gt;'
    }
}</code></pre>
            </div>
            <p>
                Your Gradle file should now look like this:
            </p>
            <div class="well">
                <pre><code>apply plugin: 'com.android.application'

android {
    compileSdkVersion 21
    buildToolsVersion "21.0.2"

    signingConfigs {
        config {
            keyAlias '&lt;Your-certificate-alias&gt;'
            keyPassword '&lt;Your-certificate-password&gt;'
            storeFile file('&lt;The-qualified-path-to-your-certificate&gt;')
            storePassword '&lt;Your-keystore-password&gt;'
        }
    }
    defaultConfig {
        applicationId "com.ibm.mil.readyapps.physio"
        minSdkVersion 16
        targetSdkVersion 19
        versionCode 1
        versionName "1.0"
    }
    buildTypes {
        release {
            ...
        }
        ...
    }
    ...
}</code></pre>
        
            </div>

            <h3>4. Update MobileFirst Platform Server Properties </h3>

            <p> We need to point the app to the MobileFirst server backend in order to properly leverage all the features and functionalities. You may point to a local server running on your laptop or a production server. In Android Studio, navigate to the <code>app/assets</code> folder and open up the <code>wlclient.properties</code> file. Update the <code>host</code> and <code>port</code> values to point to the appropriate server. The MobileFirst APIs have been integrated with the Android project, so there is no other configuration required. </p>

                    <div class="left">
                        <img src="../img/android-wl.png" style="height:400px;margin-top:25px;" />
                    </div>
            
            <h3>5. Compile &amp; Run</h3>
        
            <p>
                Now the code has everything it needs to run the application. Choose <span class="bold">Run &gt; Run 'app'</span> to run the application.
            </p>
            
            <h2 id="build-logging-in">Logging Into the App</h2>
        
            <p>Use the following user IDs and passwords to log into the app. Each user ID serves a particular developmental purpose:</p>
        
            <table>
                <thead>
                    <th style="width:15%;">User ID</th>
                    <th style="width:15%;">Password</th>
                    <th style="width:70%;">Purpose</th>
                </thead>
                <tbody>
                    <tr>
                        <td><code>user1</code></td>
                        <td><code>password1</code></td>
                        <td>Use this to log into the app cleanly without producing artifical HealthKit data. This option is best suited for devices that already have HealthKit data logged on them.</td>
                    </tr>
                    <tr>
                        <td><code>user2</code></td>
                        <td><code>password2</code></td>
                        <td>Use this to produce artifical HealthKit data before logging into the app. This option is best suited for devices that have no HealthKit data logged on them.</td>
                    </tr>
                </tbody>
            </table>
            
            <h1 id="dev-hybrid">Developing the Hybrid Code</h1>
            
            <p>If you wish to develop the hybrid code, it is recommended you develop on either Apple Safari or Google Chrome, as these are the same browsers that iOS and Android use, respectively.</p>
            
            <p>Before developing on a browser, you will need to create a test server with Node so that AngularJS will work correctly. You can write your Node server however you like. For the sake of this tutorial, ours will be named <code>test-server.js</code>.</p>
            
            <p>Here is an example test server that we wrote for our own testing. Please note that you will have to install a few dependencies with the Node Package Manager for this code to work:</p>
            
            <div class="well">
                <code>
                    var connect = require('connect');<br/>
                    var serveStatic = require('serve-static');<br/>
                    <br/>
                    connect().use(serveStatic('.')).listen(5000);    
                </code>
            </div>
            
            <p>After creating your test server, navigate to the <code>html</code> directory and run:</p>
            
            <div class="well">
                <code>$ node test-server</code>
            </div>
            
            <p>Stylesheets are generated using Sass. To start Sass, navigate to the <code>html</code> directory and run:</p>
            
            <div class="well">
                <code>$ sass --style=compressed --sourcemap=none -C --watch scss/main.scss:css/style.css</code>
            </div>
            
            <p>Alternatively, you may run own Sass command; just ensure that the output is compressed and named <code>style.css</code>. Please note that the command above will watch all <code>.scss</code> files for changes and recreate <code>style.css</code> every time it sees a change. To end the command above, simply use <code>Ctrl+C</code> to kill Sass.</p>
        
        
            <h1 id="hybrid-unit-tests">Running the Hybrid Unit Tests</h1>
        
            <p>In order to run the Hybrid tests, you will be using Karma as a test runner and Jasmine as a testing framework. These are already packaged in the <code>html/node_modules</code> directory for you.</p>
        
            <p>Karma expects Safari and Chrome to be installed on your machine, as those are the browsers that iOS and Android use for their hybrid views, respectively. To run the unit tests, simply run the following command from the <code>html/test</code> directory:</p>
        
            <div class="well">
                <code>$ .../node_modules/karma/bin/karma start test-config.js</code>
            </div>
        
            <p>Karma should now output what unit tests succeeded and what unit tests failed to the terminal. The actual unit tests are defined in the <code>html/test/spec</code> directory.</p>
        
        </div>
        
        <div class="footer">
            <div class="footer-container">
                <h1>You're All Set</h1>
                
                <ul>
                    <li>Previously...<br /><a href="arch.html">Physio Architecture</a></li>
                    <li>Now...<br />Read the App and Middleware documentation</li>
                </ul>
            </div>
        </div>
        
    </body>

</html>